---
title: "Homework 2"
author: "Alexey Volkov"
date: '26 декабря 2018 ã '
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Çàãðóçêà è î÷èñòêà äàííûõ

#### Çàãðóçèòå äàííûå â äàòàôðåéì, êîòîðûé íàçîâèòå data.
```{r}
data <- read.csv("https://raw.githubusercontent.com/SergeyMirvoda/da2016/master/data/calif_penn_2011.csv", sep = ',', header = TRUE)
```

#### Ñêîëüêî ñòðîê è ñòîëáöîâ â data?

```{r}
nrow(data)
ncol(data)
```

#### Âûïîëíèòå ñëåäóþùóþ êîìàíäó è îáúÿñíèòå, ÷òî îíà äåëàåò. colSums(apply(data,c(1,2), is.na))

```{r}
colSums(apply(data, c(1,2), is.na))
```

Äàííàÿ ôóíêöèÿ âû÷èñëÿåò êîëè÷åñòâî NaN çíà÷åíèé â êàæäîé êîëîíêå dataframe.

#### Ôóíêöèÿ na.omit() ïðèíèìàåò äàòàôðåéì è âîçâðàùàåò íîâûé äàòàôðåéì, èãíîðèðóÿ ñòðîêè, ñîäåðæàùèå çíà÷åíèå NA. Èñïîëüçóéòå ýòó ôóíêöèþ äëÿ óäàëåíèÿ ñòðîê ñ íåïîëíûìè äàííûìè.

```{r}
filtered.data<-na.omit(data)
```

#### Ñêîëüêî ñòðîê áûëî óäàëåíî?

```{r}
nrow(data)-nrow(filtered.data)
```

#### Ñîîòâåòñòâóåò ëè ðåçóëüòàò âûïîëíåíèÿ, çíà÷åíèÿì èç ïóíêòà 3?

```{r}
colSums(apply(filtered.data, c(1,2), is.na))
```

Äà, òàê êàê âî âñåõ êîëîíêàõ dataframe ñîäåðæèòñÿ 0 çíà÷åíèé NaN.

## Íîâûå äîìà

#### Ïåðåìåííàÿ(êîëîíêà) Built_2005_or_later ñîäåðæèò äàííûå î ïðîöåíòå äîìîâ, ïîñòðîåííûõ ñ 2005 ãîäà. Ïîñòðîéòå äèàãðàììó ðàññåÿíèÿ (scatterplot) ìåäèàíû ñòîèìîñòè äîìîâ (ïåðåìåííàÿ Median_house_value) îòíîñèòåëüíî ïðîöåíòà íîâûõ äîìîâ.

```{r}
plot(filtered.data$Built_2005_or_later, filtered.data$Median_house_value, xlab = "Build 2005 or later", ylab = "Median house value")
```

#### Ïîñòðîéòå åù¸ äâà ãðàôèêà äëÿ êàæäîãî èç øòàòîâ îòäåëüíî. Íîìåð øòàòà ñîäåðæèòñÿ â ïåðåìåííîé (STATEFP), ãäå Êàëèôîðíèÿ 6-é øòàò, à Ïåíñèëüâàíèÿ 42.

```{r}
plot(filtered.data$Built_2005_or_later[filtered.data$STATEFP==6], filtered.data$Median_house_value[filtered.data$STATEFP==6], main = "Êàëèôîðíèÿ", xlab = "Build 2005 or later", ylab = "Median house value")
```

```{r}
plot(filtered.data$Built_2005_or_later[filtered.data$STATEFP==42], filtered.data$Median_house_value[filtered.data$STATEFP==42], main = "Ïåíñèëüâàíèÿ", xlab = "Build 2005 or later", ylab = "Median house value")
```

#### Íåçàíÿòûå äîìà

#### Óðîâåíü íàéìà (vacancy rate) — äîëÿ äîìîâ, êîòîðûå íå áûëè çàíÿòû. Â äàííûõ ñîäåðæàòñÿ êîëîíêè, ñîäåðæàùèå îáùåå êîëè÷åñòâî äîìîâëàäåíèé è êîëè÷åñòâî íå çàíÿòûõ äîìîâëàäåíèé.

#### Â äàòàôðåéì data äîáàâüòå íîâóþ êîëîíêó vacancy_rate, êîòîðàÿ äîëæíà ñîäåðæàòü âûøåîïèñàííûé ïîêàçàòåëü.

```{r}
filtered.data$vacancy_rate <- filtered.data$Vacant_units / filtered.data$Total_units
```

#### Íàéäèòå ìèíèìóì, ìàêñèìóì, ñðåäíåå è ìåäèàíó ïîëó÷åííûõ çíà÷åíèé ïîêàçàòåëÿ.

```{r}
min(filtered.data$vacancy_rate)
max(filtered.data$vacancy_rate)
mean(filtered.data$vacancy_rate)
median(filtered.data$vacancy_rate)
```

#### Ïîñòðîéòå äèàãðàììó óðîâíÿ íàéìà îòíîñèòåëüíî ìåäèàíû ñòîèìîñòè äîìîâ. ×òî ìîæíî çàìåòèòü?

```{r}
plot(filtered.data$Median_house_value, filtered.data$vacancy_rate, xlab = "Median house value", ylab = "Vacancy rate")
```

×åì âûøå ñòîèìîñòü äîìîâ, òåì íèæå óðîâåíü íàéìà.

## Êîððåëÿöèÿ

#### Êîëîíêà COUNTYFP ñîäåðæèò ÷èñëîâîé êîä îêðóãà âíóòðè øòàòà. Íàñ èíòåðåñóþò Butte County (îêðóã 7 â Êàëèôîðíèè), Santa Clara (îêðóã 85 â Êàëèôîðíèè) è York County (îêðóã 133 â Ïåíñèëüâàíèè).

#### Îáúÿñíèòå, ÷òî äåëàåò ïðèâåä¸ííûé â êîíöå çàäàíèÿ êîä è êàê èìåííî îí ýòî äåëàåò.

Ñîçäà¸ì âûáîðêó ïî îêðóãó èç óêàçàííîãî øòàòà

acc <- c()
for (tract in 1:nrow(ca_pa)) {
  if (ca_pa$STATEFP[tract] == 6) {
    if (ca_pa$COUNTYFP[tract] == 1) {
      acc <- c(acc, tract)
    }
  }
}

Ïîäñ÷èòûâûàåì Median_house_value (10 êîëîíêà)

accmv <- c()
for (tract in acc) {
  accmv <- c(accmv, ca_pa[tract,10])
}
median(accmv)

```{r}
acc <- c()
for (tract in 1:nrow(filtered.data)) {
  if (filtered.data$STATEFP[tract] == 6) {
    if (filtered.data$COUNTYFP[tract] == 1) {
      acc <- c(acc, tract)
    }
  }
}
accmv <- c()
for (tract in acc) {
  accmv <- c(accmv, filtered.data[tract,10])
}
median(accmv)
```

#### Íàïèøèòå äðóãèì ñïîñîáîì â îäíó ñòðîêó, òî æå ñàìîå, ÷òî äåëàåò íèæåóêàçàííûé êîä. Ñïîñîáîâ ïîëó÷èòü òîò æå îòâåò ìíîæåñòâî, äîñòàòî÷íî îäíîãî.

```{r}
median(filtered.data$Median_house_value[filtered.data$STATEFP==6 & filtered.data$COUNTYFP == 1])
```

#### Íàéäèòå ñðåäíèé ïðîöåíò ïîñòðîåííûõ äîìîâëàäåíèé â îêðóãàõ (Butte County, Santa Clara, York County)

- Äëÿ Butte County
```{r}
mean(filtered.data$Built_2005_or_later[filtered.data$STATEFP==6 & filtered.data$COUNTYFP == 7])
```
- Äëÿ Santa Clara

```{r}
mean(filtered.data$Built_2005_or_later[filtered.data$STATEFP==6 & filtered.data$COUNTYFP == 85])
```
- Äëÿ York County

```{r}
mean(filtered.data$Built_2005_or_later[filtered.data$STATEFP==42 & filtered.data$COUNTYFP == 133])
```

#### Ôóíêöèÿ cor ðàññ÷èòûâàåò êîýôôèöèåíò êîððåëÿöèè ìåæäó äâóìÿ ïåðåìåííûìè. Ðàññ÷èòàéòå êîððåëÿöèþ ìåæäó ìåäèàíû ñòîèìîñòè äîìîâëàäåíèé (Median_house_value) è ïðîöåíòîì ïîñòðîåííûõ äîìîâ (Built_2005_or_later)

 - äëÿ âñåãî íàáîðà äàííûõ
 
```{r}
cor(filtered.data$Median_house_value, filtered.data$Built_2005_or_later)
```
 
 - äëÿ Êàëèôîðíèè (6)

```{r}
cor(filtered.data$Median_house_value[filtered.data$STATEFP==6], filtered.data$Built_2005_or_later[filtered.data$STATEFP==6])
```

 - äëÿ Ïåíñèëüâàíèè (42)
 
```{r}
cor(filtered.data$Median_house_value[filtered.data$STATEFP==42], filtered.data$Built_2005_or_later[filtered.data$STATEFP==42])
```
 
 - äëÿ îêðóãà Butte County (7)
 
```{r}
cor(filtered.data$Median_house_value[filtered.data$STATEFP==6 & filtered.data$COUNTYFP == 7], filtered.data$Built_2005_or_later[filtered.data$STATEFP==6 & filtered.data$COUNTYFP == 7])
```
 
 - äëÿ îêðóãà Santa Clara (85)
 
```{r}
cor(filtered.data$Median_house_value[filtered.data$STATEFP==6 & filtered.data$COUNTYFP == 85], filtered.data$Built_2005_or_later[filtered.data$STATEFP==6 & filtered.data$COUNTYFP == 85])
```
 
 - äëÿ îêðóãà York County (133)
 
```{r}
cor(filtered.data$Median_house_value[filtered.data$STATEFP==42 & filtered.data$COUNTYFP == 133], filtered.data$Built_2005_or_later[filtered.data$STATEFP==42 & filtered.data$COUNTYFP == 133])
```
 
#### Ïîñòðîéòå òðè äèàãðàììû ìåäèàíû ñòîèìîñòè äîìîâëàäåíèé (Median_house_value) îòíîñèòåëüíî ìåäèàíû äîõîäà (Median_household_income) äëÿ òð¸õ îêðóãîâ. Äîïóñòèìî óêàçàòü âñå òðè íà îäíîì ãðàôèêå.

```{r}
#par(mfrow=c(1,3))
plot(filtered.data$Median_household_income[filtered.data$STATEFP==6 & filtered.data$COUNTYFP == 7], filtered.data$Median_house_value[filtered.data$STATEFP==6 & filtered.data$COUNTYFP == 7],main="Butte County", xlab="Ìåäèàíû äîõîäà äîìîâëàäåíèé", ylab="Ìåäèàíû ñòîèìîñòè äîìîâëàäåíèé")

plot(filtered.data$Median_household_income[filtered.data$STATEFP==6 & filtered.data$COUNTYFP == 85], filtered.data$Median_house_value[filtered.data$STATEFP==6 & filtered.data$COUNTYFP == 85],main="Santa Clara",xlab="Ìåäèàíû äîõîäà äîìîâëàäåíèé", ylab="Ìåäèàíû ñòîèìîñòè äîìîâëàäåíèé")

plot(filtered.data$Median_household_income[filtered.data$STATEFP==42 & filtered.data$COUNTYFP == 133], filtered.data$Median_house_value[filtered.data$STATEFP==42 & filtered.data$COUNTYFP == 133],main="York County",xlab="Ìåäèàíû äîõîäà äîìîâëàäåíèé", ylab="Ìåäèàíû ñòîèìîñòè äîìîâëàäåíèé")
```

